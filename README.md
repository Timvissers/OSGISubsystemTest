# Project Setup

## Bundles

### service

Defines a service

	Service#useMe(String)

and an implementation

	DefaultService

that capitalizes the passed-in string.

This DefaultService is registered using an Activator (i.e. no Blueprint here).

### service-user

Uses a ServiceTracker on the Service, calls it every two seconds and prints.

## Subsystems

* service-subsystem contains service
* service-user-subsystem contains service-user and depends on service-subsystem

# How to build

	mvn clean install

# How to run

## runner

This is a minimal runner that has aries support, gogo shell (also the subsystem extension) and logging.

To use it, run

	mvn pax:provision

# Repository support

## Repository

Testing with some repository files:

repository/repo.xml

* is a manually created repository file, following the *repository spec*

* bundle resolving does not work! obr:deploy -s be.aca.service-user results in an unsatisfied constraint

repository/felixbundlerepository.xml

* will be generated by the maven-bundle-plugin, seems to be *felix specific*

* bundle resolving works well. When running obr:deploy -s be.aca.service-user, dependencies are nicely resolved and the bundles get started

repository/index.xml

* generated by org.osgi.impl.bundle.repoindex.cli.jar

* like repo.xml, but a bit worse

TODO We would like to get the first one, which follows the spec, to work

Steps to reproduce the not working bundle resolving

	obr:repos add file:///D:/workspace/osgi-subsystem-support/runner/repo.xml <change to your path>
	obr:deploy be.aca.service-user

# Subsystems

Use the shell to install subsystems. E.g.

	subsystem:install file:///D:/workspace/osgi-subsystem-support/service-subsystem/target/service-subsystem-0.0.1-SNAPSHOT.esa
	subsystem:install file:///D:/workspace/osgi-subsystem-support/service-user-subsystem/target/service-user-subsystem-0.0.1-SNAPSHOT.esa
	subsystem:list
	subsystem:start 1
	subsystem:start 2

# Subsystems support in repository

Our goal is to have our subsystems in the repository

## repository/felixbundlerepository.xml

Putting subsystems in here is not supported (we think)

## repository/repo.xml

TODO Dependencies between subsystems that can be resolved. Not getting this to work as we are not even getting repositories without subsystems to work (see above)
